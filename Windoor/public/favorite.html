<!DOCTYPE html>
<html lang="en">

<head>
   
   
    <meta charset="utf-8">
    <title>Instruction page</title>
    <!-- favicon for Windoor -->
    <link rel="shortcut icon" type="image/png" href="image/favicon.png">

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!--  CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!--  CSS - Custom styles for this template -->
    <link href="css/scrolling-nav.css" rel="stylesheet">
    <link rel="stylesheet" href="css/index.css">
   
    <!-- JS -->
    

    <script src="https://www.gstatic.com/firebasejs/7.9.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.9.2/firebase-firestore.js"></script>
    <script src="js/javasc.js"> </script>
    <script src="https://www.gstatic.com/firebasejs/7.9.2/firebase-auth.js"></script>
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- JS -- Custom JavaScript for this theme -->
  <script src="js/scrolling-nav.js"></script>
  <script src="js/instruction.js"></script>
  <!--  JS -- Plugin JavaScript -->
  <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

<!-- --------------------------------------------------->


</head>

<body>
    <!----------------------->
    <!--  HTML Section -->
    <!----------------------->

       <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark" id="mainNav">
      <div class="container">
        <a class="navbar-brand js-scroll-trigger" href="index.html"> Windoor </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav ml-auto">
            
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="account.html">My Account</a>
            </li>

            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="favorite.html">Favorites</a>
            </li>

                <li class="nav-item">
                  <a class="nav-link js-scroll-trigger" href="selectionKids.html">Kids Zone</a>
                </li>

                <li class="nav-item">
                  <a class="nav-link js-scroll-trigger" href="selectionAdults.html">Adults Zone</a>
                </li>
             
                <li>
                  <a class="nav-link js-scroll-trigger" href="index.html" id="signout"> Sign Out </a> <!-- Signout page or something to signal the user that he/she has signed out -->
                </li>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <p id="name">  <p>
<!------------------------------>
    
    <div id="buttons" class="container py-3">
      <!--Row with two equal columns-->
      <div class="row">
       
          </div>
          
          <div class="col-md-4">
           
          </div>

      </div>
  </div>
<!--------------------------------->
        

      </div>
  </div>

   
      <button id="namee" style="display: none;"> </button>



    

    <div style="text-align: center;"> 
    <p id="description" style="display: block; margin-left: auto; margin-right: auto; width: 80%;"> </p> 
    </div>

  <!-- Footer -->
  <footer class="py-1 bg-dark fixed-bottom">
    <div class="container">
      <p class="m-0 text-center text-white">Copyright &copy; Windoor</p>
    </div>
    <!-- /.container -->
  </footer>



   <script>

var videndes = {};

       firebase.auth().onAuthStateChanged(function (user) {
  if (user) {
    document.getElementById("name").innerHTML = "Your personal favorite section " + user.displayName
    document.getElementById("namee").value = user.email  
    docsize()
    
  } else {
      // No user is signed in.
  }
});

    
//////////////////////////////////////////////////////////////////////////////////////////////////////////
       function docsize() {
        let email = document.getElementById("namee").value;
       // document.getElementById("unfavorite").style.color = "Yellow";
        
console.log(email)
       

       db.collection("useraccount").doc(email).collection("favorite").get().then(snapshot => {
            length = snapshot.size

          
         
        //  createbutton(length)
        pulldoclistncreatebutton(length)
}) 
      

       }
    



function pulldoclistncreatebutton(length) {
  let email = document.getElementById("namee").value;
  console.log("test" + email)
  const events = firebase.firestore().collection('useraccount').doc(email).collection("favorite")
  events.get().then((querySnapshot) => {
      const doclist = []
      querySnapshot.forEach((doc) => {
         doclist.push({ id: doc.id, ...doc.data() })
      })
      console.log(doclist)
      for(i = 0; i < length; i++) {
      //console.log(doclist[i].activity)
     // console.log(doclist[i].category)

      let btn = document.createElement("BUTTON");
      
      btn.id = doclist[i].activity
      btn.value = doclist[i].category
      btn.innerHTML = doclist[i].activity
      btn.className = "ccc"
      btn.setAttribute("onclick", "selactivity(this.id); redirect()");
      
      document.getElementById("buttons").appendChild(btn);

      let br = document.createElement("p")
      br.innerHTML = "<br>"
      document.getElementById("buttons").appendChild(br);
  

      }
   })
 }

 pulldoclistncreatebutton()


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////



       function selactivity(clicked_id) {
           

 

           let selcatego = document.getElementById(clicked_id).value;   //gets user input
           let selecteac = document.getElementById(clicked_id).id;
           console.log(selcatego);
           console.log(selecteac);
           db.collection("useractselc").doc("catenact").set({
               category: selcatego,
               activities: selecteac
           })
          
  
       }



   
    addEventListener("load",function(){
      
      var link = document.getElementsByClassName("instr");
      for (i = 0; i < 50; i++) {
      link[i].addEventListener("click",function(e){
          e.preventDefault();
          
          // after 0.5 seconds, relocate user to the link
          setTimeout(function(){ 
            window.location.href = "instructionpage.html"; }, 500);
          }) 
  }}); 


  addEventListener("load",function(){
      
      var link = document.getElementsByClassName("ccc");
      for (i = 0; i < 50; i++) {
      link[i].addEventListener("click",function(e){
          e.preventDefault();
          
          // after 0.5 seconds, relocate user to the link
          setTimeout(function(){ 
            window.location.href = "instructionpage.html"; }, 500);
          }) 
  }}); 


function redirect() {

  setTimeout(function(){ 
            window.location.href = "instructionpage.html"; }, 500);
}


    </script>



<script src="js/signout.js"></script>


</body>

</html>